<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>PENGPUMP - Jump on Candlesticks!</title>
    
    <!-- SEO Meta Tags -->
            <meta name="description" content="Play the exciting PENGPUMP game! Jump on candlesticks to create new ones and achieve high scores. A fun trading-themed platformer game.">
    <meta name="keywords" content="game, platformer, candlestick, trading, crypto, browser game, free game">
            <meta name="author" content="PENGPUMP">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph Meta Tags -->
            <meta property="og:title" content="PENGPUMP">
    <meta property="og:description" content="Jump on candlesticks to create new ones! A fun trading-themed platformer game.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourusername.github.io/candlestick-platformer">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
            <meta name="twitter:title" content="PENGPUMP">
    <meta name="twitter:description" content="Jump on candlesticks to create new ones! A fun trading-themed platformer game.">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            color: #fff;
            overflow: hidden;
            cursor: none;
        }

        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f0f23, #1a1a2e, #16213e);
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            z-index: 1000;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 2rem 2rem 1rem 2rem;
        }
        
        .loading::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="%23ffffff" stroke-width="0.1" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.3;
        }

        .loading-text {
            font-size: 4rem;
            font-weight: 900;
            margin-bottom: 2rem;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            position: relative;
        }
        
        .title-main {
            background: linear-gradient(135deg, #FFD700, #FFA500, #FF6B35, #FF4500);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientShift 3s ease-in-out infinite, titleFloat 2s ease-in-out infinite;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
            position: relative;
            cursor: default;
        }
        
        .title-main::before {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: blur(8px);
            opacity: 0.7;
            z-index: -1;
        }
        
        .title-separator {
            color: #FFD700;
            font-size: 3rem;
            font-weight: 300;
            animation: separatorPulse 2s ease-in-out infinite;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
        }
        
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        @keyframes titleFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes separatorPulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.8; }
        }
        
        .title-main:hover {
            animation-play-state: paused;
            transform: scale(1.1);
            transition: transform 0.3s ease;
        }
        
        /* Floating particles around title */
        .loading-text::before,
        .loading-text::after {
            content: '';
            position: absolute;
            width: 4px;
            height: 4px;
            background: #FFD700;
            border-radius: 50%;
            animation: particleFloat 4s ease-in-out infinite;
        }
        
        .loading-text::before {
            top: -20px;
            left: 20%;
            animation-delay: 0s;
        }
        
        .loading-text::after {
            top: -30px;
            right: 20%;
            animation-delay: 2s;
        }
        
        @keyframes particleFloat {
            0%, 100% { 
                transform: translateY(0px) scale(1);
                opacity: 0.8;
            }
            50% { 
                transform: translateY(-20px) scale(1.5);
                opacity: 0.3;
            }
        }
        
        /* Responsive design for title */
        @media (max-width: 768px) {
            .loading-text {
                font-size: 3.5rem;
                gap: 0.5rem;
            }
            
            .title-separator {
                font-size: 2rem;
            }
        }
        
        /* Wallet Connect Button Styles */
        .wallet-connect-section {
            position: fixed;
            top: 2rem;
            right: 2rem;
            z-index: 1000;
            text-align: center;
        }
        
        .connect-wallet-btn {
            background: linear-gradient(135deg, #6366F1, #8B5CF6, #A855F7);
            border: 2px solid rgba(99, 102, 241, 0.3);
            border-radius: 15px;
            padding: 1rem 2rem;
            color: white;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(99, 102, 241, 0.3);
            display: inline-flex;
            align-items: center;
            gap: 0.8rem;
            position: relative;
            overflow: hidden;
        }
        
        .connect-wallet-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }
        
        .connect-wallet-btn:hover::before {
            left: 100%;
        }
        
        .connect-wallet-btn:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 30px rgba(99, 102, 241, 0.4);
            border-color: rgba(99, 102, 241, 0.6);
        }
        
        .connect-wallet-btn:active {
            transform: translateY(-1px) scale(0.98);
        }
        
        .wallet-icon {
            font-size: 1.3rem;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }
        
        .wallet-text {
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        .wallet-status {
            margin-top: 1rem;
            padding: 0.8rem 1.5rem;
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: inline-block;
            transition: all 0.3s ease;
        }
        
        .wallet-status.connected {
            background: rgba(34, 197, 94, 0.2);
            border-color: rgba(34, 197, 94, 0.4);
        }
        
        .wallet-status.connected .status-text {
            color: #22C55E;
        }
        
        .wallet-status.error {
            background: rgba(239, 68, 68, 0.2);
            border-color: rgba(239, 68, 68, 0.4);
        }
        
        .wallet-status.error .status-text {
            color: #EF4444;
        }
        
        .status-text {
            color: #E5E7EB;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        /* Fixed player image positioning on the bottom left side */
        .player-image-section-fixed {
            position: fixed;
            bottom: 2rem;
            left: 2rem;
            z-index: 1000;
            text-align: center;
        }
        
        .landing-player-image {
            width: 200px;
            height: auto;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
        }
        
        .landing-player-image:hover {
            transform: scale(1.05);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.6);
        }
        
        /* Fixed leaderboard positioning on the left side */
        .leaderboard-section-fixed {
            position: fixed;
            top: 2rem;
            left: 2rem;
            width: 380px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.8);
            border: 3px solid #FFD700;
            border-radius: 15px;
            padding: 1.5rem;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(255, 215, 0, 0.3);
        }
        
        /* Leaderboard Table Styles */
        .leaderboard-section {
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 15px;
            padding: 1.5rem;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(255, 215, 0, 0.1);
        }
        
        .leaderboard-title {
            color: #FFD700;
            font-size: 1.3rem;
            font-weight: bold;
            text-align: center;
            margin: 0 0 1.5rem 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }
        
        .leaderboard-table {
            width: 100%;
        }
        
        .table-header {
            display: grid;
            grid-template-columns: 40px 1fr 80px 80px;
            gap: 0.5rem;
            padding: 0.8rem 0;
            border-bottom: 2px solid rgba(255, 215, 0, 0.3);
            margin-bottom: 1rem;
        }
        
        .table-header span {
            color: #FFD700;
            font-weight: bold;
            font-size: 0.9rem;
            text-align: center;
        }
        
        .table-body {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .leaderboard-entry {
            display: grid;
            grid-template-columns: 40px 1fr 80px 80px;
            gap: 0.5rem;
            padding: 0.8rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .leaderboard-entry:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }
        
        .leaderboard-entry.rank-1 {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 215, 0, 0.1));
            border-color: rgba(255, 215, 0, 0.5);
        }
        
        .leaderboard-entry.rank-2 {
            background: linear-gradient(135deg, rgba(192, 192, 192, 0.2), rgba(192, 192, 192, 0.1));
            border-color: rgba(192, 192, 192, 0.5);
        }
        
        .leaderboard-entry.rank-3 {
            background: linear-gradient(135deg, rgba(205, 127, 50, 0.2), rgba(205, 127, 50, 0.1));
            border-color: rgba(205, 127, 50, 0.5);
        }
        
        .rank-col {
            text-align: center;
            font-weight: bold;
            color: #FFD700;
        }
        
        .wallet-col {
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            color: #E5E7EB;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .score-col, .time-col {
            text-align: center;
            color: #E5E7EB;
            font-weight: 500;
        }
        
        /* Responsive design for fixed elements */
        @media (max-width: 1200px) {
            .player-image-section-fixed {
                /* Mantener fijo en la esquina inferior izquierda */
                position: fixed;
                bottom: 1rem;
                left: 1rem;
            }
            
            .landing-player-image {
                width: 120px; /* Un poco más pequeño en pantallas pequeñas */
            }
            
            .wallet-connect-section {
                position: fixed;
                top: 1rem;
                right: 1rem;
            }
            
            .leaderboard-section-fixed {
                position: fixed;
                top: 1rem;
                left: 1rem;
                width: 320px;
            }
        }
        
        /* Additional responsive adjustments for better spacing */
        @media (max-width: 768px) {
            .loading {
                padding: 1.5rem 1rem 1rem 1rem;
            }
            
            .loading-text {
                font-size: 3rem;
                margin-bottom: 1.5rem;
            }
            
            .player-image-section-fixed {
                position: fixed;
                bottom: 0.5rem;
                left: 0.5rem;
            }
            
            .landing-player-image {
                width: 100px; /* Más pequeño en móviles */
            }
            
            .wallet-connect-section {
                position: fixed;
                top: 0.5rem;
                right: 0.5rem;
            }
            
            .leaderboard-section-fixed {
                position: fixed;
                top: 0.5rem;
                left: 0.5rem;
                width: 280px;
                padding: 1rem;
            }
            
            .airdrop-info-box {
                margin: 1rem auto;
                padding: 0.875rem;
            }
            
            .loading-bar-container {
                margin: 1rem 0;
            }
            
            .start-button {
                margin-top: 1rem;
            }
            
            .landing-social-buttons {
                margin-top: 1rem;
            }
        }

        .loading-instructions {
            text-align: center;
            line-height: 1.5;
            opacity: 0.7;
        }

        .loading-numbers {
            position: absolute;
            bottom: 2rem;
            font-family: monospace;
            opacity: 0.3;
        }
        
        .loading-bar-container {
            width: 300px;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            margin: 1.5rem 0;
            overflow: hidden;
            position: relative;
        }
        
        .loading-bar {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049, #66BB6A);
            border-radius: 4px;
            width: 0%;
            transition: width 0.3s ease;
            position: relative;
        }
        
        .loading-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .loading-percentage {
            font-size: 1.2rem;
            font-weight: 300;
            margin-top: 1rem;
            opacity: 0.8;
        }
        
        .start-button {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            border: 2px solid #2E7D32;
            border-radius: 12px;
            padding: 1rem 2rem;
            color: white;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1.5rem;
            opacity: 0;
            transform: translateY(20px);
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }
        
        .start-button:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.4);
            background: linear-gradient(135deg, #66BB6A, #4CAF50);
            border-color: #388E3C;
        }
        
        .start-button.show {
            opacity: 1;
            transform: translateY(0);
        }

        .main-content {
            position: relative;
            width: 100%;
            height: 100vh;
            padding: 2rem;
        }

        .hero {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .title {
            font-size: 6rem;
            font-weight: 300;
            margin-bottom: 1rem;
            cursor: pointer;
        }

        .more-details {
            opacity: 0.7;
            cursor: pointer;
        }

        .back-button, .social-buttons, .menu-button, .close-button {
            position: absolute;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.3s;
        }

        .back-button:hover, .social-buttons:hover, .menu-button:hover, .close-button:hover {
            opacity: 1;
        }

        .back-button {
            top: 2rem;
            left: 2rem;
        }

        .social-buttons {
            top: 2rem;
            right: 2rem;
            display: flex;
            gap: 1rem;
        }
        
        .telegram-button, .twitter-button {
            position: relative;
            width: 100px;
            height: 140px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 10px;
        }
        
        .telegram-button:hover, .twitter-button:hover {
            transform: translateY(-3px) scale(1.05);
            filter: brightness(1.2);
        }
        
        .candlestick {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .wick-upper {
            width: 4px;
            height: 30px;
            background: #666;
            border-radius: 2px;
            margin-bottom: 4px;
        }
        
        .candle-body {
            width: 60px;
            height: 70px;
            border-radius: 4px;
            position: relative;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(0, 0, 0, 0.2);
        }
        
        .telegram-button .candle-body {
            background: linear-gradient(135deg, #4CAF50, #66BB6A);
            border-color: #2E7D32;
        }
        
        .twitter-button .candle-body {
            background: linear-gradient(135deg, #EF5350, #F44336);
            border-color: #C62828;
        }
        
        .candle-body::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            border-radius: 4px;
        }
        
        .wick-lower {
            width: 4px;
            height: 24px;
            background: #666;
            border-radius: 2px;
            margin-top: 4px;
        }
        
        .telegram-button span, .twitter-button span {
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            z-index: 2;
            background: rgba(0, 0, 0, 0.8);
            padding: 6px 12px;
            border-radius: 8px;
            white-space: nowrap;
            min-width: 120px;
            text-align: center;
        }
        
        /* Landing Page Social Buttons */
        .landing-social-buttons {
            display: flex;
            gap: 2rem;
            justify-content: center;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .landing-telegram-button, .landing-twitter-button {
            position: relative;
            width: 80px;
            height: 110px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .landing-telegram-button:hover, .landing-twitter-button:hover {
            transform: translateY(-3px) scale(1.05);
            filter: brightness(1.2);
        }
        
        .landing-candlestick {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .landing-wick-upper {
            width: 3px;
            height: 24px;
            background: #666;
            border-radius: 2px;
            margin-bottom: 3px;
        }
        
        .landing-candle-body {
            width: 48px;
            height: 56px;
            border-radius: 3px;
            position: relative;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(0, 0, 0, 0.2);
        }
        
        .landing-telegram-button .landing-candle-body {
            background: linear-gradient(135deg, #4CAF50, #66BB6A);
            border-color: #2E7D32;
        }
        
        .landing-twitter-button .landing-candle-body {
            background: linear-gradient(135deg, #EF5350, #F44336);
            border-color: #C62828;
        }
        
        .landing-candle-body::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            border-radius: 3px;
        }
        
        .landing-wick-lower {
            width: 3px;
            height: 20px;
            background: #666;
            border-radius: 2px;
            margin-top: 3px;
        }
        
        .landing-telegram-button span, .landing-twitter-button span {
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 1rem;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            z-index: 2;
            background: rgba(0, 0, 0, 0.8);
            padding: 4px 10px;
            border-radius: 6px;
            white-space: nowrap;
            min-width: 100px;
            text-align: center;
        }
        
        /* Airdrop Information Box Styles */
        .airdrop-info-box {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 165, 0, 0.1));
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 12px;
            padding: 1rem;
            margin: 1.25rem auto;
            max-width: 450px;
            text-align: center;
            box-shadow: 0 6px 24px rgba(255, 215, 0, 0.2);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }
        
        .airdrop-info-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.1), transparent);
            animation: shimmer 3s infinite;
        }
        
        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .airdrop-info-box h3 {
            color: #FFD700;
            font-size: 1.125rem;
            font-weight: bold;
            margin: 0 0 0.75rem 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            letter-spacing: 1px;
        }
        
        .airdrop-details {
            display: flex;
            flex-direction: column;
            gap: 0.6rem;
        }
        
        .airdrop-details p {
            color: #fff;
            font-size: 0.75rem;
            margin: 0;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
            line-height: 1.4;
        }
        
        .airdrop-details strong {
            color: #FFD700;
            font-weight: bold;
        }
        
        /* Responsive design for airdrop box */
        @media (max-width: 768px) {
            .airdrop-info-box {
                margin: 1.125rem 0.75rem;
                padding: 0.75rem;
                max-width: 350px;
            }
            
            .airdrop-info-box h3 {
                font-size: 1rem;
            }
            
            .airdrop-details p {
                font-size: 0.7rem;
            }
        }

        .menu-button {
            bottom: 2rem;
            right: 2rem;
        }

        .close-button {
            bottom: 2rem;
            left: 2rem;
        }
        


        .profile {
            position: absolute;
            bottom: 8rem;
            left: 2rem;
            max-width: 300px;
            opacity: 0.7;
        }

        .view-works {
            margin-top: 1rem;
            cursor: pointer;
            text-decoration: underline;
        }

        .settings-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            padding: 2rem;
            z-index: 999;
            display: none;
        }

        .close-settings {
            position: absolute;
            top: 2rem;
            right: 2rem;
            cursor: pointer;
        }

        .setting-group {
            margin-bottom: 2rem;
        }

        .setting-group h3 {
            margin-bottom: 1rem;
        }

        .setting-options {
            display: flex;
            gap: 1rem;
        }

        .option {
            padding: 0.5rem 1rem;
            border: 1px solid #fff;
            cursor: pointer;
            opacity: 0.7;
        }

        .option.active {
            opacity: 1;
            background: #fff;
            color: #000;
        }

        .setting-actions {
            position: absolute;
            bottom: 2rem;
            right: 2rem;
            display: flex;
            gap: 1rem;
        }

        .action {
            padding: 0.5rem 1rem;
            border: 1px solid #fff;
            cursor: pointer;
        }

        .action.error {
            border-color: #ff4444;
            color: #ff4444;
        }

        .action.ok {
            border-color: #44ff44;
            color: #44ff44;
        }

        #game-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
        }

        .custom-cursor {
            position: fixed;
            width: 32px;
            height: 32px;
            background: #00FF66; /* Verde vibrante exacto de la imagen */
            border-radius: 50%;
            pointer-events: none;
            z-index: 10000;
            transition: transform 0.2s ease;
            cursor: none;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .custom-cursor::before {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background: white;
            clip-path: polygon(50% 0%, 100% 25%, 75% 50%, 100% 75%, 50% 100%, 0% 75%, 25% 50%, 0% 25%);
            transform: rotate(0deg);
            transition: all 0.2s ease;
        }
        
        .custom-cursor::after {
            content: '';
            position: absolute;
            width: 16px;
            height: 16px;
            background: #00FF66;
            clip-path: polygon(50% 0%, 75% 25%, 50% 50%, 75% 75%, 50% 100%, 25% 75%, 50% 50%, 25% 25%);
            transform: rotate(0deg);
            transition: all 0.2s ease;
        }
        
        .custom-cursor:hover::before {
            transform: rotate(120deg) scale(1.1);
        }
        
        .custom-cursor:hover::after {
            transform: rotate(120deg) scale(1.1);
        }
        
        .custom-cursor:hover {
            transform: scale(1.1);
            filter: drop-shadow(0 0 15px rgba(0, 255, 102, 0.8));
        }

        .controls-info {
            display: none; /* Hidden to avoid overlap with game UI */
        }
    </style>
</head>
<body>
    <div class="loading">
        <div class="loading-text">
            <span class="title-main">PENG</span>
            <span class="title-separator">•</span>
            <span class="title-main">PUMP</span>
                </div>
        
                <!-- Connect Wallet Button -->
        <div class="wallet-connect-section">
            <button id="connect-wallet-btn" class="connect-wallet-btn">
                <span class="wallet-icon">🦊</span>
                <span class="wallet-text">Connect MetaMask</span>
            </button>
            <div id="wallet-status" class="wallet-status">
                <span class="status-text">Wallet not connected</span>
            </div>
        </div>
        
        <!-- Airdrop Information Box -->
        <div class="airdrop-info-box">
            <h3>🏆 AIRDROP REWARDS SYSTEM</h3>
            <div class="airdrop-details">
                <p><strong>🎯 Objective:</strong> Reach the top of the leaderboard to earn airdrops!</p>
                <p><strong>⏰ Distribution:</strong> Airdrops are distributed every 6 hours</p>
                <p><strong>🔄 Reset:</strong> Leaderboard resets after each airdrop distribution</p>
                <p><strong>💰 Rewards:</strong> Top players receive exclusive tokens and rewards</p>
                <p><strong>🏁 Competition:</strong> Keep jumping and improving your score!</p>
            </div>
        </div>
        
        <div class="loading-bar-container">
            <div class="loading-bar"></div>
        </div>
        
        <div class="loading-percentage">0%</div>
        
        <button class="start-button">START JUMPING</button>
        
        <!-- Social Media Buttons on Landing Page -->
        <div class="landing-social-buttons">
            <div class="landing-telegram-button" onclick="window.open('https://t.me/your_channel', '_blank')">
                <div class="landing-candlestick">
                    <div class="landing-wick-upper"></div>
                    <div class="landing-candle-body"></div>
                    <div class="landing-wick-lower"></div>
                </div>
                <span>Telegram</span>
            </div>
            <div class="landing-twitter-button" onclick="window.open('https://x.com/PengPump_ABS', '_blank')">
                <div class="landing-candlestick">
                    <div class="landing-wick-upper"></div>
                    <div class="landing-candle-body"></div>
                    <div class="landing-wick-lower"></div>
                </div>
                <span>Twitter</span>
            </div>
        </div>
        
        <!-- Player Image (Positioned to the left) -->
        <div class="player-image-section-fixed">
            <img src="./player.png" alt="PENGPUMP Player" class="landing-player-image">
        </div>
        
        <!-- Leaderboard Table (Positioned to the right) -->
        <div class="leaderboard-section-fixed">
            <h3 class="leaderboard-title">🏆 TOP PLAYERS</h3>
            <div class="leaderboard-table">
                <div class="table-header">
                    <span class="rank-col">#</span>
                    <span class="wallet-col">Wallet Address</span>
                    <span class="score-col">Score</span>
                    <span class="time-col">Time</span>
                </div>
                <div class="table-body" id="leaderboard-body">
                    <!-- Leaderboard entries will be populated here -->
                </div>
            </div>
        </div>

    </div>

             <main class="main-content">
        <div class="info-panel" style="position: fixed; bottom: 120px; right: 20px; z-index: 1000; text-align: right; background: rgba(0, 0, 0, 0.7); padding: 15px; border-radius: 10px; max-width: 300px;">
            <h2 style="margin: 0 0 10px 0; font-size: 18px; color: #fff; text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">PENGPUMP</h2>
            <p style="margin: 0 0 8px 0; font-size: 12px; color: #ccc; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">jump to create new candlesticks!</p>
            <p style="margin: 0 0 8px 0; font-size: 12px; color: #ccc; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">back</p>
            <p style="margin: 0 0 8px 0; font-size: 12px; color: #ccc; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">Telegram & Twitter</p>

            <p style="margin: 0 0 8px 0; font-size: 12px; color: #ccc; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">menu</p>
            <p style="margin: 0 0 8px 0; font-size: 12px; color: #ccc; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">restart</p>
            <p style="margin: 0 0 8px 0; font-size: 12px; color: #ccc; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">Pattern: Bullish/Bearish</p>
            <p style="margin: 0 0 8px 0; font-size: 12px; color: #ccc; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">Welcome to the exciting world of candlestick jumping! Jump on candlesticks to automatically create new ones.</p>
            <p style="margin: 0 0 8px 0; font-size: 12px; color: #ccc; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">start jumping!</p>
        </div>

        <div class="back-button">
            <span>back</span>
        </div>

        <div class="social-buttons">
            <div class="telegram-button" onclick="window.open('https://t.me/your_channel', '_blank')">
                <div class="candlestick">
                    <div class="wick-upper"></div>
                    <div class="candle-body"></div>
                    <div class="wick-lower"></div>
                </div>
                <span>Telegram</span>
            </div>
            <div class="twitter-button" onclick="window.open('https://x.com/PengPump_ABS', '_blank')">
                <div class="candlestick">
                    <div class="wick-upper"></div>
                    <div class="candle-body"></div>
                    <div class="wick-lower"></div>
                </div>
                <span>Twitter</span>
            </div>
        </div>
        


        <div class="menu-button">
            <span>menu</span>
        </div>

        <div class="close-button">
            <span>restart</span>
        </div>

        <div class="settings-panel">
            <h2>settings</h2>
            <div class="close-settings">
                <span>close</span>
            </div>

            <div class="setting-group">
                <h3>display mode</h3>
                <div class="setting-options">
                    <div class="option active">full</div>
                    <div class="option">simple</div>
                    <div class="option">minimum</div>
                </div>
            </div>

            <div class="setting-group">
                <h3>menu position</h3>
                <div class="setting-options">
                    <div class="option active">bottom<br>- right</div>
                    <div class="option">bottom<br>- left</div>
                    <div class="option">top -<br>right</div>
                </div>
            </div>

            <div class="setting-group">
                <h3>color scheme</h3>
                <div class="setting-subgroup">
                    <h4>auto light / dark mode</h4>
                    <p>whether to depend on the OS setting.</p>
                    <div class="setting-options">
                        <div class="option">off</div>
                        <div class="option active">on</div>
                    </div>
                </div>
                <div class="setting-subgroup">
                    <h4>light / dark mode</h4>
                    <p>if "auto light / dark mode" setting is off, you can select color scheme.</p>
                    <div class="setting-options">
                        <div class="option">light</div>
                        <div class="option active">dark</div>
                    </div>
                </div>
            </div>

            <div class="setting-actions">
                <div class="action error">error</div>
                <div class="action ok">ok</div>
            </div>
        </div>
    </main>

    <canvas id="game-canvas"></canvas>
    <div class="custom-cursor"></div>
    <div class="controls-info">
        WASD/Arrows: Move | SPACE: Jump | Click: Add Candlesticks
    </div>



    <script>
        // PENGPUMP - 2D Game with Cartoon Candlesticks
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');
        
                         // Game state
        let gameState = 'loading';
        let candlesticks = [];
        let playerImage = null;
                let player = {
            x: 100,
            y: 400,
            width: 45,
            height: 60,
            vx: 0,
            vy: 0,
            onGround: false,
            color: '#FF6B6B'
        };
         
         let camera = {
             x: 0,
             y: 0
         };
         
         let keys = {};
         let gravity = 0.6; // Reduced gravity for better control
         let jumpPower = -18; // Stronger jump
         let moveSpeed = 3; // Slower movement for better precision
         
         // Game mechanics
         let score = 0;
         let gameOver = false;
         let highestCandlestick = 0;
         let trendStrength = 0; // For realistic market patterns
         let gameOverTime = 0; // For popup animation
         let scorePopup = null; // For score animation
         
         // Infinite pattern mechanics
         let patternDirection = 'bullish'; // 'bullish' or 'bearish'
         let patternHeight = 0; // Current height percentage (0-100)
         let baseHeight = 0; // Base height for calculations
         
         // Restart protection
         let restartCooldown = false;
         
         // Lava floor properties
         let lavaFloor = {
             y: 0,
             height: 50,
             color: '#FF4500',
             glowColor: '#FF6347'
         };
         
                  // Death particles for when player touches lava
         let deathParticles = [];
         
                 // High score system variables
        let highScores = [];
        let playerName = '';
        let showHighScoreForm = false;
        let isNewHighScore = false;
        let currentHighScore = 0;
        
        // Missile system variables
        let missiles = [];
        let missileSpeed = 8; // Even faster for more challenge
        let missileSpawnInterval = 1500; // 1.5 seconds - very frequent spawning
        let lastMissileSpawn = 0;
        let missileDamage = 1;
        
        // Audio system variables
        let audioContext = null;
        let jumpSound = null;
        let scoreSound = null;
        let missileSound = null;
        let deathSound = null;
         
        
        
         
         // Initialize game
         function init() {
             // Prevent multiple initializations
             if (gameState === 'restarting') {
                 console.log('Game is restarting, please wait...');
                 return;
             }
             
             canvas.width = window.innerWidth;
             canvas.height = window.innerHeight;
             
                         // Load high scores
            loadHighScores();
            
            // Load player image
            playerImage = new Image();
            playerImage.src = './player.png';
            
            // Initialize audio system
            initAudio();
            
            // Create initial candlesticks (1 and 2) with varied sizes
             createCandlestick(100, canvas.height - 100, 100, 'bullish');
             createCandlestick(220, canvas.height - 120, 120, 'bullish');
             
             // Set lava floor position
             lavaFloor.y = canvas.height - 50;
             
                         // Set player starting position on top of the first candlestick
            player.x = 100 + (35 / 2) - (player.width / 2); // Centered on first candlestick
            player.y = canvas.height - 180; // Higher above the candlestick for better visibility with larger player
             
             gameState = 'playing';
             gameLoop();
         }
         
         // High Score System Functions
         function loadHighScores() {
             const saved = localStorage.getItem('candlestickHighScores');
             if (saved) {
                 highScores = JSON.parse(saved);
             } else {
                 // Default high scores
                 highScores = [
                     { name: 'PRO', score: 150, date: '2024-01-01' },
                     { name: 'CHAMP', score: 120, date: '2024-01-01' },
                     { name: 'LEGEND', score: 100, date: '2024-01-01' },
                     { name: 'HERO', score: 80, date: '2024-01-01' },
                     { name: 'STAR', score: 60, date: '2024-01-01' }
                 ];
             }
         }
         
         function saveHighScores() {
             localStorage.setItem('candlestickHighScores', JSON.stringify(highScores));
         }
         
         function checkHighScore() {
             if (score > 0) {
                 // Check if this score qualifies for top 5
                 const minScore = highScores.length > 0 ? highScores[highScores.length - 1].score : 0;
                 
                 if (score > minScore || highScores.length < 5) {
                     isNewHighScore = true;
                     currentHighScore = score;
                     showHighScoreForm = true;
                     
                     // Add to high scores
                     const newScore = {
                         name: playerName || 'ANONYMOUS',
                         score: score,
                         date: new Date().toISOString().split('T')[0]
                     };
                     
                     highScores.push(newScore);
                     highScores.sort((a, b) => b.score - a.score); // Sort by score descending
                     
                     // Keep only top 5
                     if (highScores.length > 5) {
                         highScores = highScores.slice(0, 5);
                     }
                     
                     saveHighScores();
                 }
             }
         }
         
         function submitHighScore() {
             if (playerName.trim()) {
                 // Update the last added score with the player name
                 const lastScore = highScores.find(hs => hs.score === currentHighScore);
                 if (lastScore) {
                     lastScore.name = playerName.trim().toUpperCase();
                     saveHighScores();
                 }
                 
                 showHighScoreForm = false;
                 isNewHighScore = false;
             }
         }
         
         // Create realistic candlestick with varied sizes
         function createCandlestick(x, y, value, type) {
             const isBullish = type === 'bullish';
             
             // Much more varied body heights for realistic chart appearance
             const minHeight = 20; // Very small candles
             const maxHeight = 120; // Very large candles
             
             // Random body height with some influence from value
             const randomFactor = Math.random() * 0.8 + 0.2; // 0.2 to 1.0
             const valueInfluence = Math.abs(value - 100) / 100; // How much value affects size
             const bodyHeight = Math.floor(minHeight + (maxHeight - minHeight) * (randomFactor * 0.7 + valueInfluence * 0.3));
             
             // Varied wick lengths - some very short, some very long
             const wickVariation = Math.random();
             let upperWick, lowerWick;
             
             if (wickVariation < 0.3) {
                 // Short wicks (30% chance)
                 upperWick = Math.random() * 15 + 5;
                 lowerWick = Math.random() * 15 + 5;
             } else if (wickVariation < 0.7) {
                 // Medium wicks (40% chance)
                 upperWick = Math.random() * 30 + 15;
                 lowerWick = Math.random() * 30 + 15;
             } else {
                 // Long wicks (30% chance)
                 upperWick = Math.random() * 50 + 30;
                 lowerWick = Math.random() * 50 + 30;
             }
             
             // Random width variation for more realistic appearance
             const widthVariation = Math.random() * 10 + 30; // 30 to 40px
             
             const candlestick = {
                 x: x,
                 y: y,
                 width: widthVariation, // Variable width
                 bodyHeight: bodyHeight,
                 upperWick: upperWick, // Separate upper and lower wicks
                 lowerWick: lowerWick,
                 value: value,
                 type: type,
                 color: isBullish ? '#4CAF50' : '#F44336',
                 bodyColor: isBullish ? '#66BB6A' : '#EF5350',
                 visited: false // Track if player has landed on this candlestick
             };
             
             candlesticks.push(candlestick);
                 }
        
        // Audio system functions
        function initAudio() {
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                createSounds();
            } catch (e) {
                console.log('Audio not supported:', e);
            }
        }
        
        function createSounds() {
            // Jump sound (high pitch beep)
            jumpSound = createBeep(800, 0.1, 'sine');
            
            // Score sound (success chime)
            scoreSound = createBeep(1200, 0.15, 'square');
            
            // Missile sound (low pitch whoosh)
            missileSound = createBeep(300, 0.2, 'sawtooth');
            
            // Death sound (low pitch rumble)
            deathSound = createBeep(150, 0.3, 'triangle');
        }
        
        function createBeep(frequency, duration, type) {
            if (!audioContext) return null;
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = frequency;
            oscillator.type = type;
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
            
            return { oscillator, gainNode, duration };
        }
        
        function playSound(sound) {
            if (!sound || !audioContext) return;
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = sound.oscillator.frequency.value;
            oscillator.type = sound.oscillator.type;
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + sound.duration);
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + sound.duration);
        }
        
        // Missile system functions
        function createMissile() {
            // Calculate direction towards player with some randomness
            const targetX = player.x;
            const targetY = player.y + player.height / 2; // Aim for player center
            
            // PREDICT player position based on current velocity (lead the target)
            const predictionTime = 0.5; // Predict 0.5 seconds ahead
            const predictedX = targetX + (player.vx * predictionTime);
            const predictedY = targetY + (player.vy * predictionTime);
            
            // PROGRESSIVE DIFFICULTY: Missiles get more precise as you advance
            const difficultyFactor = Math.min(0.8, candlesticks.length / 50); // 0 to 0.8 based on progress
            const baseRandomnessX = 40 * (1 - difficultyFactor); // Less randomness as you progress
            const baseRandomnessY = 30 * (1 - difficultyFactor); // Less randomness as you progress
            
            // Add minimal randomness to make missiles more precise
            const randomOffsetX = (Math.random() - 0.5) * baseRandomnessX;
            const randomOffsetY = (Math.random() - 0.5) * baseRandomnessY;
            
            const finalTargetX = predictedX + randomOffsetX;
            const finalTargetY = predictedY + randomOffsetY;
            
            // Calculate angle to target
            const dx = finalTargetX - (camera.x + canvas.width);
            const dy = finalTargetY - (Math.random() * (canvas.height - 200) + 100);
            const angle = Math.atan2(dy, dx);
            
            const missile = {
                x: camera.x + canvas.width, // Create missile at the right edge of the game world
                y: Math.random() * (canvas.height - 200) + 100,
                width: 20,
                height: 8,
                speed: missileSpeed,
                vx: Math.cos(angle) * missileSpeed, // Horizontal velocity component
                vy: Math.sin(angle) * missileSpeed, // Vertical velocity component
                active: true
            };
            missiles.push(missile);
            
            // Play missile sound
            playSound(missileSound);
        }
        
        function updateMissiles() {
            const currentTime = Date.now();
            
            // Spawn new missiles
            if (currentTime - lastMissileSpawn > missileSpawnInterval) {
                createMissile();
                lastMissileSpawn = currentTime;
            }
            
            // Update existing missiles
            missiles.forEach((missile, index) => {
                // Move missile using velocity components
                missile.x += missile.vx;
                missile.y += missile.vy;
                
                // Remove missiles that are off screen (left, right, top, or bottom)
                if (missile.x + missile.width < camera.x - 100 || 
                    missile.x > camera.x + canvas.width + 100 ||
                    missile.y + missile.height < 0 ||
                    missile.y > canvas.height + 100) {
                    missiles.splice(index, 1);
                }
                
                // Check collision with player
                if (missile.active && 
                    player.x < missile.x + missile.width &&
                    player.x + player.width > missile.x &&
                    player.y < missile.y + missile.height &&
                    player.y + player.height > missile.y) {
                    
                    // Player hit by missile
                    missile.active = false;
                    playSound(deathSound);
                    gameOver = true;
                    checkHighScore();
                }
            });
        }
        
        function drawMissiles() {
            missiles.forEach(missile => {
                if (missile.active) {
                    // Calculate missile rotation based on velocity
                    const angle = Math.atan2(missile.vy, missile.vx);
                    
                    ctx.save();
                    ctx.translate(missile.x - camera.x + missile.width / 2, missile.y - camera.y + missile.height / 2);
                    ctx.rotate(angle);
                    
                    // Draw missile body (red) - now rotated
                    ctx.fillStyle = '#FF0000';
                    ctx.fillRect(-missile.width / 2, -missile.height / 2, missile.width, missile.height);
                    
                    // Draw missile tip (orange) - at the front based on direction
                    ctx.fillStyle = '#FF6600';
                    ctx.fillRect(missile.width / 2 - 5, -missile.height / 2, 5, missile.height);
                    
                    // Draw missile trail (yellow) - behind the missile
                    ctx.fillStyle = '#FFFF00';
                    ctx.fillRect(-missile.width / 2 - 8, -2, 8, 4);
                    
                    ctx.restore();
                }
            });
        }
        
        // Draw realistic candlestick chart style with varied sizes
         function drawCandlestick(candlestick) {
             const x = candlestick.x - camera.x;
             const y = candlestick.y - camera.y;
             
             // Calculate wick positions (upper and lower wicks separate)
             const upperWickTop = y - candlestick.upperWick;
             const lowerWickBottom = y + candlestick.bodyHeight + candlestick.lowerWick;
             
             // Draw upper wick (above body)
             ctx.strokeStyle = '#666'; // Dark gray wick
             ctx.lineWidth = 2;
             ctx.beginPath();
             ctx.moveTo(x + candlestick.width / 2, y);
             ctx.lineTo(x + candlestick.width / 2, upperWickTop);
             ctx.stroke();
             
             // Draw lower wick (below body)
             ctx.beginPath();
             ctx.moveTo(x + candlestick.width / 2, y + candlestick.bodyHeight);
             ctx.lineTo(x + candlestick.width / 2, lowerWickBottom);
             ctx.stroke();
             
             // Draw body with outline
             ctx.fillStyle = candlestick.bodyColor;
             ctx.fillRect(x, y, candlestick.width, candlestick.bodyHeight);
             
             // Draw body outline
             ctx.strokeStyle = '#333'; // Dark gray outline
             ctx.lineWidth = 1;
             ctx.strokeRect(x, y, candlestick.width, candlestick.bodyHeight);
             
             // No numerical labels - cleaner chart appearance
             // Only small trend indicator for gameplay
             ctx.fillStyle = candlestick.type === 'bullish' ? '#4CAF50' : '#F44336';
             ctx.font = '8px Arial';
             ctx.fillText(candlestick.type === 'bullish' ? '↗' : '↘', x + candlestick.width / 2, upperWickTop - 5);
         }
        
        // Draw player using image
        function drawPlayer() {
            const x = player.x - camera.x;
            const y = player.y - camera.y;
            
            // Draw player image if loaded, otherwise fallback to simple rectangle
            if (playerImage && playerImage.complete) {
                ctx.drawImage(playerImage, x, y, player.width, player.height);
            } else {
                // Fallback to simple blue rectangle if image not loaded
                ctx.fillStyle = '#4A90E2';
                ctx.fillRect(x, y, player.width, player.height);
            }
        }
        
                 // Update player physics
         function updatePlayer() {
             // Don't update player if game is over
             if (gameOver) return;
             
             // Apply gravity
             player.vy += gravity;
             
             // Move player
             player.x += player.vx;
             player.y += player.vy;
             
             // Check candlestick collisions and award points
             player.onGround = false;
             candlesticks.forEach(candlestick => {
                 if (player.x < candlestick.x + candlestick.width &&
                     player.x + player.width > candlestick.x &&
                     player.y + player.height >= candlestick.y &&
                     player.y + player.height <= candlestick.y + candlestick.bodyHeight) {
                     
                     // Check if this is a new candlestick the player hasn't landed on yet
                                         if (!candlestick.visited) {
                        candlestick.visited = true;
                        score += 1; // Award 1 point for each new candlestick landed on
                        
                        // Play score sound
                        playSound(scoreSound);
                        
                        // Show score popup
                        scorePopup = {
                            x: candlestick.x,
                            y: candlestick.y - 50,
                            text: '+1',
                            time: Date.now(),
                            alpha: 1
                        };
                        
                        // Create next candlestick automatically when landing on this one
                        createNextCandlestick();
                    }
                     
                     player.y = candlestick.y - player.height;
                     player.vy = 0;
                     player.onGround = true;
                 }
             });
             
             // Check for game over (player touched lava or got left behind)
             if (player.y + player.height >= lavaFloor.y || player.x < camera.x - 150) {
                 if (!gameOver) {
                     gameOver = true;
                     gameOverTime = Date.now(); // Record when game over happened
                     console.log('Game Over! Player touched lava or got left behind');
                     
                     // Create death particles
                     createDeathParticles();
                     
                     // Stop player movement completely
                     player.vx = 0;
                     player.vy = 0;
                     
                     // Force player to stay in place
                     player.x = Math.max(camera.x - 100, player.x);
                     player.y = Math.min(lavaFloor.y - player.height - 10, player.y);
                     
                     // Check for high score
                     checkHighScore();
                 }
                 return;
             }
             
             // Keep player in bounds
             if (player.y > canvas.height - 100) {
                 player.y = canvas.height - 100;
                 player.vy = 0;
                 player.onGround = true;
             }
             
             // Camera follow player
             camera.x = player.x - canvas.width / 3;
             camera.x = Math.max(0, camera.x);
         }
        
                 // Handle input
         function handleInput() {
             // Don't handle input if game is over
             if (gameOver) return;
             
             // Horizontal movement
             if (keys['a'] || keys['ArrowLeft']) {
                 player.vx = -moveSpeed;
             } else if (keys['d'] || keys['ArrowRight']) {
                 player.vx = moveSpeed;
             } else {
                 player.vx = 0;
             }
             
                         // Jump
            if ((keys['w'] || keys['ArrowUp'] || keys[' ']) && player.onGround) {
                player.vy = jumpPower;
                player.onGround = false;
                playSound(jumpSound);
            }
         }
        
                 // Game loop
         function gameLoop() {
             if (gameState !== 'playing') return;
             
             // Clear canvas
             ctx.clearRect(0, 0, canvas.width, canvas.height);
             
             // Handle input
             handleInput();
             
                         // Update game objects
            updatePlayer();
            updateMissiles();
            
            // Draw background
            drawBackground();
            
            // Draw candlesticks
            candlesticks.forEach(drawCandlestick);
            
            // Draw missiles
            drawMissiles();
            
            // Draw player
            drawPlayer();
            
            // Update and draw death particles
            updateDeathParticles();
            
            // Draw UI
            drawUI();
             
             // Continue game loop even during game over (for UI display)
             requestAnimationFrame(gameLoop);
         }
        
                 // Draw background
         function drawBackground() {
             // Gradient background
             const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
             gradient.addColorStop(0, '#1a1a2e');
             gradient.addColorStop(0.5, '#16213e');
             gradient.addColorStop(1, '#0f3460');
             ctx.fillStyle = gradient;
             ctx.fillRect(0, 0, canvas.width, canvas.height);
             
             // Grid lines
             ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
             ctx.lineWidth = 1;
             
             for (let x = 0; x < canvas.width; x += 50) {
                 ctx.beginPath();
                 ctx.moveTo(x, 0);
                 ctx.lineTo(x, canvas.height);
                 ctx.stroke();
             }
             
             for (let y = 0; y < canvas.height; y += 50) {
                 ctx.beginPath();
                 ctx.moveTo(0, y);
                 ctx.lineTo(canvas.width, y);
                 ctx.stroke();
             }
             
             // Draw lava floor
             drawLavaFloor();
         }
         
         // Draw animated lava floor
         function drawLavaFloor() {
             const time = Date.now() * 0.005; // Animation speed
             
             // Main lava body
             ctx.fillStyle = lavaFloor.color;
             ctx.fillRect(0, lavaFloor.y, canvas.width, lavaFloor.height);
             
             // Animated lava surface with bubbles
             ctx.fillStyle = lavaFloor.glowColor;
             for (let x = 0; x < canvas.width; x += 30) {
                 const bubbleY = lavaFloor.y + Math.sin(x * 0.02 + time) * 3;
                 const bubbleSize = 2 + Math.sin(x * 0.03 + time * 2) * 2;
                 
                 ctx.beginPath();
                 ctx.arc(x, bubbleY, bubbleSize, 0, Math.PI * 2);
                 ctx.fill();
             }
             
             // Lava glow effect
             const glowGradient = ctx.createLinearGradient(0, lavaFloor.y - 20, 0, lavaFloor.y + lavaFloor.height);
             glowGradient.addColorStop(0, 'rgba(255, 69, 0, 0.3)');
             glowGradient.addColorStop(1, 'rgba(255, 69, 0, 0.8)');
             ctx.fillStyle = glowGradient;
             ctx.fillRect(0, lavaFloor.y - 20, canvas.width, 20);
             
             // Warning text above lava
             ctx.fillStyle = '#FF4500';
             ctx.font = 'bold 16px Arial';
             ctx.textAlign = 'center';
             ctx.fillText('🔥 LAVA - DON\'T TOUCH! 🔥', canvas.width / 2, lavaFloor.y - 10);
             
             // Draw pattern direction arrows
             drawPatternArrows();
         }
         
         // Draw pattern direction arrows
         function drawPatternArrows() {
             const arrowY = 100;
             const arrowSize = 20;
             
             if (patternDirection === 'bullish') {
                 // Green up arrow
                 ctx.fillStyle = '#4CAF50';
                 ctx.font = 'bold 24px Arial';
                 ctx.textAlign = 'center';
                 ctx.fillText('⬆️ BULLISH', canvas.width / 2, arrowY);
             } else {
                 // Red down arrow
                 ctx.fillStyle = '#F44336';
                 ctx.font = 'bold 24px Arial';
                 ctx.textAlign = 'center';
                 ctx.fillText('⬇️ BEARISH', canvas.width / 2, arrowY);
             }
         }
         
         // Create next candlestick automatically when player lands on one
         function createNextCandlestick() {
             const lastCandlestick = candlesticks[candlesticks.length - 1];
             if (!lastCandlestick) return;
             
             // Calculate next position (moving right and slightly up for bullish trend)
             const newX = lastCandlestick.x + 120; // Wider spacing for challenging jumps
             
             // Calculate current height percentage for infinite pattern
             const currentHeight = canvas.height - lastCandlestick.y;
             const heightPercentage = (currentHeight / (canvas.height - 100)) * 100;
             
             // Calculate height limits (20% to 80% of screen)
             const minHeight = canvas.height * 0.2; // 20% from top
             const maxHeight = canvas.height * 0.8; // 80% from top
             
             // Much more random and varied pattern like real charts
             let newY, newValue, newType;
             
             // Higher randomness for more realistic market movements
             const randomDirection = Math.random();
             const trendInfluence = 0.2; // Reduced trend influence for more randomness
             
             // More varied movement distances
             const movementVariation = Math.random();
             let movementDistance;
             
             if (movementVariation < 0.3) {
                 // Small movements (30% chance)
                 movementDistance = Math.random() * 30 + 10;
             } else if (movementVariation < 0.7) {
                 // Medium movements (40% chance)
                 movementDistance = Math.random() * 60 + 30;
             } else {
                 // Large movements (30% chance)
                 movementDistance = Math.random() * 80 + 60;
             }
             
             if (randomDirection < 0.5 + (patternDirection === 'bullish' ? trendInfluence : -trendInfluence)) {
                 // Bullish pattern (upward)
                 newY = lastCandlestick.y - movementDistance;
                 newValue = lastCandlestick.value + Math.floor(Math.random() * 40 + 15);
                 newType = 'bullish';
                 score += 10;
                 patternDirection = 'bullish';
             } else {
                 // Bearish pattern (downward)
                 newY = lastCandlestick.y + movementDistance;
                 newValue = Math.max(50, lastCandlestick.value - Math.floor(Math.random() * 35 + 15));
                 newType = 'bearish';
                 score += 5;
                 patternDirection = 'bearish';
             }
             
             // Enforce height limits (20% to 80% of screen)
             newY = Math.max(minHeight, Math.min(maxHeight, newY));
             newValue = Math.max(50, Math.min(300, newValue));
             
             // Track highest candlestick for achievement
             if (newY < highestCandlestick || highestCandlestick === 0) {
                 highestCandlestick = newY;
                 score += 25; // Bonus for reaching new heights
             }
             
             // Create the new candlestick
             createCandlestick(newX, newY, newValue, newType);
         }
         
         // Create death particles when player touches lava
         function createDeathParticles() {
             deathParticles = [];
             for (let i = 0; i < 20; i++) {
                 deathParticles.push({
                     x: player.x + player.width / 2,
                     y: player.y + player.height / 2,
                     vx: (Math.random() - 0.5) * 8,
                     vy: (Math.random() - 0.5) * 8,
                     life: 1,
                     decay: 0.02,
                     color: ['#FF4500', '#FF6347', '#FF8C00', '#FFD700'][Math.floor(Math.random() * 4)]
                 });
             }
         }
         

         
         // Restart game function
         function restartGame() {
             console.log('Restarting game...');
             
             // Stop current game loop
             gameState = 'restarting';
             
                         // Clear all game objects
            candlesticks = [];
            deathParticles = [];
            missiles = [];
            scorePopup = null;
             
                         // Reset all game variables
            score = 0;
            gameOver = false;
            gameOverTime = 0;
            trendStrength = 0;
            patternDirection = 'bullish';
            patternHeight = 0;
            restartCooldown = false;
            lastMissileSpawn = 0;
             
             // Reset high score system variables
             playerName = '';
             showHighScoreForm = false;
             isNewHighScore = false;
             currentHighScore = 0;
             
             // Reset player
               player.x = 100 + (35 / 2) - (player.width / 2);
               player.y = canvas.height - 160;
             player.vx = 0;
             player.vy = 0;
             player.onGround = false;
             
             // Reset camera
             camera.x = 0;
             camera.y = 0;
             
             // Wait a bit then restart
             setTimeout(() => {
                 console.log('Game restarted successfully!');
                 gameState = 'playing';
                 init();
             }, 100);
         }
         
         // Update and draw death particles
         function updateDeathParticles() {
             if (deathParticles.length === 0) return;
             
             for (let i = deathParticles.length - 1; i >= 0; i--) {
                 const particle = deathParticles[i];
                 
                 // Update particle
                 particle.x += particle.vx;
                 particle.y += particle.vy;
                 particle.life -= particle.decay;
                 
                 // Draw particle
                 ctx.save();
                 ctx.globalAlpha = particle.life;
                 ctx.fillStyle = particle.color;
                 ctx.beginPath();
                 ctx.arc(particle.x - camera.x, particle.y - camera.y, 3, 0, Math.PI * 2);
                 ctx.fill();
                 ctx.restore();
                 
                 // Remove dead particles
                 if (particle.life <= 0) {
                     deathParticles.splice(i, 1);
                 }
             }
         }
        
                 // Draw UI
         function drawUI() {
             if (gameOver) {
                 // Animated Game Over popup with entrance animation
                 const popupWidth = 400;
                 const popupHeight = 300;
                 const popupX = canvas.width / 2 - popupWidth / 2;
                 const popupY = canvas.height / 2 - popupHeight / 2;
                 
                 // Calculate animation progress (0 to 1 over 500ms)
                 const animationProgress = Math.min(1, (Date.now() - gameOverTime) / 500);
                 const scale = 0.5 + (animationProgress * 0.5); // Start small, grow to normal
                 const opacity = animationProgress;
                 
                 // Semi-transparent background overlay with fade in
                 ctx.fillStyle = `rgba(0, 0, 0, ${0.7 * opacity})`;
                 ctx.fillRect(0, 0, canvas.width, canvas.height);
                 
                 // Apply scaling transformation for popup with shake effect
                 ctx.save();
                 ctx.translate(canvas.width / 2, canvas.height / 2);
                 ctx.scale(scale, scale);
                 
                 // Add shake effect when popup appears
                 if (animationProgress > 0.8) {
                     const shakeIntensity = (1 - animationProgress) * 3;
                     const shakeX = (Math.random() - 0.5) * shakeIntensity;
                     const shakeY = (Math.random() - 0.5) * shakeIntensity;
                     ctx.translate(shakeX, shakeY);
                 }
                 
                 ctx.translate(-canvas.width / 2, -canvas.height / 2);
                 
                 // Popup background with shadow
                 ctx.fillStyle = '#1a1a2e';
                 ctx.fillRect(popupX, popupY, popupWidth, popupHeight);
                 
                 // Popup border
                 ctx.strokeStyle = '#FF0000';
                 ctx.lineWidth = 4;
                 ctx.strokeRect(popupX, popupY, popupWidth, popupHeight);
                 
                 // RUG! text in red with glow effect
                 ctx.fillStyle = '#FF0000';
                 ctx.font = 'bold 72px Arial';
                 ctx.textAlign = 'center';
                 ctx.fillText('RUG!', canvas.width / 2, popupY + 80);
                 
                 // "GAME OVER" message
                 ctx.fillStyle = '#FF6B6B';
                 ctx.font = 'bold 36px Arial';
                 ctx.fillText('GAME OVER!', canvas.width / 2, popupY + 130);
                 
                 // "YOU LOST!" message
                 ctx.fillStyle = '#FF4444';
                 ctx.font = 'bold 28px Arial';
                 ctx.fillText('YOU LOST!', canvas.width / 2, popupY + 160);
                 
                 // "BURNED IN LAVA!" message
                 ctx.fillStyle = '#FF4500';
                 ctx.font = 'bold 24px Arial';
                 ctx.fillText('🔥 BURNED IN LAVA! 🔥', canvas.width / 2, popupY + 190);
                 
                 // Score display
                 ctx.fillStyle = '#fff';
                 ctx.font = '24px Arial';
                 ctx.fillText(`Final Score: ${score}`, canvas.width / 2, popupY + 220);
                 
                 // Candlesticks count
                 ctx.fillText(`Candlesticks Survived: ${candlesticks.length}`, canvas.width / 2, popupY + 250);
                 
                 // Instructions to restart
                 ctx.fillStyle = '#4CAF50';
                 ctx.font = 'bold 20px Arial';
                 ctx.fillText('Press R key to restart', canvas.width / 2, popupY + 290);
                 
                 // High Score Form
                 if (showHighScoreForm && isNewHighScore) {
                     // High score form background
                     ctx.fillStyle = 'rgba(0, 0, 0, 0.9)';
                     ctx.fillRect(popupX + 50, popupY + 320, popupWidth - 100, 200);
                     
                     // Form title
                     ctx.fillStyle = '#FFD700';
                     ctx.font = 'bold 24px Arial';
                     ctx.fillText('🏆 NEW HIGH SCORE! 🏆', canvas.width / 2, popupY + 350);
                     
                     // Score display
                     ctx.fillStyle = '#fff';
                     ctx.font = '20px Arial';
                     ctx.fillText(`Score: ${currentHighScore}`, canvas.width / 2, popupY + 380);
                     
                     // Instructions
                     ctx.fillStyle = '#4CAF50';
                     ctx.font = '16px Arial';
                     ctx.fillText('Type your name and press ENTER', canvas.width / 2, popupY + 410);
                     
                     // Input field (visual representation)
                     ctx.fillStyle = '#333';
                     ctx.fillRect(popupX + 100, popupY + 420, popupWidth - 200, 30);
                     ctx.strokeStyle = '#4CAF50';
                     ctx.lineWidth = 2;
                     ctx.strokeRect(popupX + 100, popupY + 420, popupWidth - 200, 30);
                     
                     // Player name display
                     ctx.fillStyle = '#fff';
                     ctx.font = '18px Arial';
                     ctx.fillText(playerName || 'Type here...', popupX + 110, popupY + 440);
                     
                     // Submit button
                     ctx.fillStyle = '#4CAF50';
                     ctx.fillRect(popupX + 150, popupY + 460, 100, 30);
                     ctx.fillStyle = '#fff';
                     ctx.font = '16px Arial';
                     ctx.fillText('SUBMIT', popupX + 200, popupY + 480);
                     
                     // Close button (X)
                     ctx.fillStyle = '#F44336';
                     ctx.fillRect(popupX + 320, popupY + 460, 30, 30);
                     ctx.fillStyle = '#fff';
                     ctx.font = 'bold 20px Arial';
                     ctx.fillText('X', popupX + 335, popupY + 480);
                 }
                 
                 // High Scores List
                 if (highScores.length > 0) {
                     // High scores background
                     ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';
                     ctx.fillRect(popupX + 50, popupY + 540, popupWidth - 100, 150);
                     
                     // Title
                     ctx.fillStyle = '#FFD700';
                     ctx.font = 'bold 20px Arial';
                     ctx.fillText('🏆 TOP 5 HIGH SCORES 🏆', canvas.width / 2, popupY + 570);
                     
                     // High scores list
                     ctx.fillStyle = '#fff';
                     ctx.font = '16px Arial';
                     ctx.textAlign = 'left';
                     
                     highScores.forEach((hs, index) => {
                         const yPos = popupY + 600 + (index * 25);
                         const isCurrentScore = hs.score === currentHighScore && hs.name === (playerName || 'ANONYMOUS');
                         
                         // Highlight current score
                         if (isCurrentScore) {
                             ctx.fillStyle = '#FFD700';
                             ctx.fillRect(popupX + 60, yPos - 15, popupWidth - 120, 20);
                             ctx.fillStyle = '#000';
                         } else {
                             ctx.fillStyle = '#fff';
                         }
                         
                         ctx.fillText(`${index + 1}. ${hs.name}`, popupX + 70, yPos);
                         ctx.fillText(`${hs.score}`, popupX + 200, yPos);
                         ctx.fillText(hs.date, popupX + 280, yPos);
                     });
                     
                     ctx.textAlign = 'center'; // Reset text alignment
                 }
                 
                 // Show restart cooldown message
                 if (restartCooldown) {
                     ctx.fillStyle = '#FF9800';
                     ctx.font = 'bold 18px Arial';
                     ctx.fillText('Restarting... Please wait', canvas.width / 2, popupY + 720);
                 }
                 
                 ctx.restore(); // Restore transformation
                 return;
             }
             
             // Normal game UI - Organized and spaced properly
             // Top left section - Game stats
             ctx.fillStyle = '#fff';
             ctx.font = 'bold 20px Arial';
             ctx.textAlign = 'left';
             
                         // Score and candlesticks (top row)
            ctx.fillText(`Score: ${score}`, 20, 35);
            ctx.fillText(`Candlesticks: ${candlesticks.length}`, 200, 35);
            ctx.fillText(`Missiles: ${missiles.length}`, 380, 35);
             
             // Pattern and height (second row)
             ctx.fillStyle = patternDirection === 'bullish' ? '#4CAF50' : '#F44336';
             ctx.fillText(`Pattern: ${patternDirection === 'bullish' ? 'BULLISH' : 'BEARISH'}`, 20, 65);
             
             // Height percentage indicator with limits
             const currentHeight = candlesticks.length > 0 ? 
                 Math.round(((canvas.height - candlesticks[candlesticks.length - 1].y) / (canvas.height - 100)) * 100) : 0;
             
             // Color based on height limits (20% to 80%)
             let heightColor;
             if (currentHeight < 20) heightColor = '#F44336'; // Too low (red)
             else if (currentHeight > 80) heightColor = '#F44336'; // Too high (red)
             else if (currentHeight < 40) heightColor = '#4CAF50'; // Good low (green)
             else if (currentHeight > 60) heightColor = '#4CAF50'; // Good high (green)
             else heightColor = '#FF9800'; // Middle range (orange)
             
             ctx.fillStyle = heightColor;
             ctx.fillText(`Height: ${currentHeight}% (20%-80%)`, 200, 65);
             
             // Player position (third row, smaller font)
             ctx.fillStyle = '#ccc';
             ctx.font = '14px Arial';
             ctx.fillText(`Position: ${Math.floor(player.x)}, ${Math.floor(player.y)}`, 20, 85);
             
             // High score indicator (fourth row)
             if (highScores.length > 0) {
                 const bestScore = highScores[0].score;
                 ctx.fillStyle = '#FFD700';
                 ctx.font = 'bold 16px Arial';
                 ctx.fillText(`Best: ${bestScore}`, 20, 105);
             }
             
             // Draw score popup if exists
             if (scorePopup) {
                 const timeSincePopup = Date.now() - scorePopup.time;
                 if (timeSincePopup < 1000) { // Show for 1 second
                     scorePopup.alpha = 1 - (timeSincePopup / 1000);
                     scorePopup.y -= 0.5; // Move up slowly
                     
                     ctx.save();
                     ctx.globalAlpha = scorePopup.alpha;
                     ctx.fillStyle = '#4CAF50';
                     ctx.font = 'bold 24px Arial';
                     ctx.textAlign = 'center';
                     ctx.fillText(scorePopup.text, scorePopup.x - camera.x, scorePopup.y - camera.y);
                     ctx.restore();
                 } else {
                     scorePopup = null; // Remove popup after animation
                 }
             }
                 }
        
        // MetaMask Wallet Connection
        let currentAccount = null;
        let isWalletConnected = false;
        
        // Check if MetaMask is installed
        function checkMetaMask() {
            if (typeof window.ethereum !== 'undefined') {
                return true;
            } else {
                return false;
            }
        }
        
        // Connect to MetaMask
        async function connectWallet() {
            const connectBtn = document.getElementById('connect-wallet-btn');
            const walletStatus = document.getElementById('wallet-status');
            const statusText = walletStatus.querySelector('.status-text');
            
            if (!checkMetaMask()) {
                // MetaMask not installed
                walletStatus.className = 'wallet-status error';
                statusText.textContent = 'MetaMask not installed!';
                connectBtn.innerHTML = '<span class="wallet-icon">❌</span><span class="wallet-text">Install MetaMask</span>';
                connectBtn.onclick = () => window.open('https://metamask.io/download/', '_blank');
                return;
            }
            
            try {
                // Request account access
                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                
                if (accounts.length > 0) {
                    currentAccount = accounts[0];
                    isWalletConnected = true;
                    
                    // Update UI
                    walletStatus.className = 'wallet-status connected';
                    statusText.textContent = `Connected: ${currentAccount.slice(0, 6)}...${currentAccount.slice(-4)}`;
                    connectBtn.innerHTML = '<span class="wallet-icon">✅</span><span class="wallet-text">Wallet Connected</span>';
                    connectBtn.style.background = 'linear-gradient(135deg, #22C55E, #16A34A)';
                    connectBtn.style.borderColor = 'rgba(34, 197, 94, 0.6)';
                    
                    // Store connection state
                    localStorage.setItem('pengpump_wallet_connected', 'true');
                    localStorage.setItem('pengpump_wallet_address', currentAccount);
                    
                    console.log('Wallet connected successfully:', currentAccount);
                }
            } catch (error) {
                console.error('Error connecting wallet:', error);
                walletStatus.className = 'wallet-status error';
                statusText.textContent = 'Connection failed!';
            }
        }
        
        // Disconnect wallet
        function disconnectWallet() {
            currentAccount = null;
            isWalletConnected = false;
            
            const connectBtn = document.getElementById('connect-wallet-btn');
            const walletStatus = document.getElementById('wallet-status');
            const statusText = walletStatus.querySelector('.status-text');
            
            // Reset UI
            walletStatus.className = 'wallet-status';
            statusText.textContent = 'Wallet not connected';
            connectBtn.innerHTML = '<span class="wallet-icon">🦊</span><span class="wallet-text">Connect MetaMask</span>';
            connectBtn.style.background = 'linear-gradient(135deg, #6366F1, #8B5CF6, #A855F7)';
            connectBtn.style.borderColor = 'rgba(99, 102, 241, 0.3)';
            connectBtn.onclick = connectWallet;
            
            // Clear stored data
            localStorage.removeItem('pengpump_wallet_connected');
            localStorage.removeItem('pengpump_wallet_address');
        }
        
        // Handle account changes
        function handleAccountsChanged(accounts) {
            if (accounts.length === 0) {
                // User disconnected wallet
                disconnectWallet();
            } else if (accounts[0] !== currentAccount) {
                // Account changed
                currentAccount = accounts[0];
                const walletStatus = document.getElementById('wallet-status');
                const statusText = walletStatus.querySelector('.status-text');
                statusText.textContent = `Connected: ${currentAccount.slice(0, 6)}...${currentAccount.slice(-4)}`;
            }
        }
        
        // Generate random wallet addresses for demo leaderboard
        function generateRandomWallet() {
            const chars = '0123456789abcdef';
            let address = '0x';
            for (let i = 0; i < 40; i++) {
                address += chars[Math.floor(Math.random() * chars.length)];
            }
            return address;
        }
        
        // Generate demo leaderboard data
        function generateDemoLeaderboard() {
            const demoData = [
                { rank: 1, wallet: '0x7a8b9c2d3e4f5a6b7c8d9e0f1a2b3c4d5e6f7a8b', score: 2230, time: '1:47' },
                { rank: 2, wallet: '0x1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c', score: 1897, time: '2:12' },
                { rank: 3, wallet: '0x9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d', score: 1564, time: '2:58' },
                { rank: 4, wallet: '0x3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e', score: 1234, time: '3:45' },
                { rank: 5, wallet: '0x5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f', score: 204, time: '4:12' }
            ];
            
            return demoData;
        }
        
        // Populate leaderboard table
        function populateLeaderboard() {
            console.log('🔄 populateLeaderboard() called');
            
            const leaderboardBody = document.getElementById('leaderboard-body');
            console.log('📊 leaderboardBody element:', leaderboardBody);
            
            if (!leaderboardBody) {
                console.error('❌ leaderboard-body element not found!');
                return;
            }
            
            const demoData = generateDemoLeaderboard();
            console.log('🎯 Demo data generated:', demoData);
            
            leaderboardBody.innerHTML = '';
            
            demoData.forEach(entry => {
                const entryElement = document.createElement('div');
                entryElement.className = `leaderboard-entry rank-${entry.rank <= 3 ? entry.rank : ''}`;
                
                entryElement.innerHTML = `
                    <span class="rank-col">${entry.rank}</span>
                    <span class="wallet-col" title="${entry.wallet}">${entry.wallet.slice(0, 8)}...${entry.wallet.slice(-6)}</span>
                    <span class="score-col">${entry.score}</span>
                    <span class="time-col">${entry.time}</span>
                `;
                
                leaderboardBody.appendChild(entryElement);
                console.log(`✅ Added entry ${entry.rank}: ${entry.score} points`);
            });
            
            console.log('🎉 Leaderboard populated successfully!');
        }
        
        // Initialize wallet connection on page load
        function initWalletConnection() {
            const connectBtn = document.getElementById('connect-wallet-btn');
            const walletStatus = document.getElementById('wallet-status');
            
            // Add click event
            connectBtn.addEventListener('click', connectWallet);
            
            // Check if wallet was previously connected
            const wasConnected = localStorage.getItem('pengpump_wallet_connected');
            const storedAddress = localStorage.getItem('pengpump_wallet_address');
            
            if (wasConnected && storedAddress && checkMetaMask()) {
                // Auto-connect if previously connected
                currentAccount = storedAddress;
                isWalletConnected = true;
                
                walletStatus.className = 'wallet-status connected';
                const statusText = walletStatus.querySelector('.status-text');
                statusText.textContent = `Connected: ${currentAccount.slice(0, 6)}...${currentAccount.slice(-4)}`;
                connectBtn.innerHTML = '<span class="wallet-icon">✅</span><span class="wallet-text">Wallet Connected</span>';
                connectBtn.style.background = 'linear-gradient(135deg, #22C55E, #16A34A)';
                connectBtn.style.borderColor = 'rgba(34, 197, 94, 0.6)';
            }
            
            // Listen for account changes
            if (window.ethereum) {
                window.ethereum.on('accountsChanged', handleAccountsChanged);
            }
        }
        
        // Event listeners
         document.addEventListener('keydown', (e) => {
             // Handle restart with R key
             if (e.key.toLowerCase() === 'r' && gameOver) {
                 restartGame();
                 return;
             }
             
             // Handle high score input
             if (showHighScoreForm && isNewHighScore) {
                 if (e.key === 'Enter') {
                     submitHighScore();
                     return;
                 } else if (e.key === 'Backspace') {
                     playerName = playerName.slice(0, -1);
                     return;
                 } else if (e.key.length === 1 && playerName.length < 12) {
                     // Only allow letters, numbers, and spaces
                     if (/[a-zA-Z0-9\s]/.test(e.key)) {
                         playerName += e.key.toUpperCase();
                     }
                     return;
                 }
             }
             
             // Only handle game keys if not in high score form
             if (!showHighScoreForm) {
                 keys[e.key.toLowerCase()] = true;
             }
         });
         
         document.addEventListener('keyup', (e) => {
             keys[e.key.toLowerCase()] = false;
         });
        
                 // Click event for high score form buttons
         canvas.addEventListener('click', (e) => {
             if (gameState !== 'playing') return;
             
             // Handle high score form button clicks
             if (showHighScoreForm && isNewHighScore && gameOver) {
                 const rect = canvas.getBoundingClientRect();
                 const x = e.clientX - rect.left;
                 const y = e.clientY - rect.top;
                 
                 // Check if submit button was clicked
                 const popupWidth = 400;
                 const popupHeight = 300;
                 const popupX = canvas.width / 2 - popupWidth / 2;
                 const popupY = canvas.height / 2 - popupHeight / 2;
                 
                 // Submit button area
                 if (x >= popupX + 150 && x <= popupX + 250 && 
                     y >= popupY + 460 && y <= popupY + 490) {
                     submitHighScore();
                     return;
                 }
                 
                 // Close button area
                 if (x >= popupX + 320 && x <= popupX + 350 && 
                     y >= popupY + 460 && y <= popupY + 490) {
                     showHighScoreForm = false;
                     isNewHighScore = false;
                     return;
                 }
             }
             
             // Click events can be used for future features
             // Restart is now only available with R key
         });
        
        // Window resize
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
        
        // Custom cursor
        const cursor = document.querySelector('.custom-cursor');
        document.addEventListener('mousemove', (e) => {
            cursor.style.left = e.clientX + 'px';
            cursor.style.top = e.clientY + 'px';
        });

        // Loading screen with progress bar and start button
        let loadingProgress = 0;
        let loadingInterval;
        
        function updateLoadingBar() {
            const loadingBar = document.querySelector('.loading-bar');
            const loadingPercentage = document.querySelector('.loading-percentage');
            const startButton = document.querySelector('.start-button');
            
            if (loadingProgress < 100) {
                loadingProgress += Math.random() * 15 + 5; // Random progress increment
                if (loadingProgress > 100) loadingProgress = 100;
                
                loadingBar.style.width = loadingProgress + '%';
                loadingPercentage.textContent = Math.floor(loadingProgress) + '%';
                
                if (loadingProgress >= 100) {
                    clearInterval(loadingInterval);
                    // Show start button with animation
                    setTimeout(() => {
                        startButton.classList.add('show');
                    }, 500);
                }
            }
        }
        
        // Start loading animation
        loadingInterval = setInterval(updateLoadingBar, 100);
        
        // Start button click handler
        document.querySelector('.start-button').addEventListener('click', () => {
            // Fade out loading screen
            const loading = document.querySelector('.loading');
            loading.style.transition = 'opacity 1s ease, transform 1s ease';
            loading.style.opacity = '0';
            loading.style.transform = 'scale(0.95)';
            
            setTimeout(() => {
                loading.style.display = 'none';
                init(); // Initialize the game
            }, 1000);
        });

                 // Original interactions - Commented out as elements don't exist
         /*
         document.querySelector('.title').addEventListener('click', () => {
             // Reset game
             restartGame();
         });

         document.querySelector('.more-details').addEventListener('click', () => {
             // Add multiple candlesticks quickly
             for (let i = 0; i < 5; i++) {
                 setTimeout(() => {
                     const lastCandlestick = candlesticks[candlesticks.length - 1];
                     if (lastCandlestick) {
                         const newX = lastCandlestick.x + 100;
                         const newY = Math.max(50, lastCandlestick.y - (Math.random() * 30 + 10));
                         const newValue = lastCandlestick.value + Math.floor(Math.random() * 20 + 10);
                         createCandlestick(newX, newY, newValue, 'bullish');
                     }
                 }, i * 200);
             }
         });

         document.querySelector('.view-works').addEventListener('click', () => {
             // Create a big bullish jump
             const lastCandlestick = candlesticks[candlesticks.length - 1];
             if (lastCandlestick) {
                 const newX = lastCandlestick.x + 100;
                 const newY = Math.max(50, lastCandlestick.y - 60); // Big jump up
                 const newValue = lastCandlestick.value + 50;
                 createCandlestick(newX, newY, newValue, 'bullish');
             }
         });
         */

        // Navigation buttons - Commented out as elements don't exist in current HTML
        /*
        document.querySelector('.back-button').addEventListener('click', () => {
            window.history.back();
        });

        document.querySelector('.telegram-button').addEventListener('click', () => {
            window.open('https://t.me/your_channel', '_blank');
        });

        document.querySelector('.twitter-button').addEventListener('click', () => {
            window.open('https://twitter.com/your_handle', '_blank');
        });

        document.querySelector('.menu-button').addEventListener('click', () => {
            document.querySelector('.settings-panel').style.display = 'block';
        });

        document.querySelector('.close-button').addEventListener('click', () => {
            // Clear all candlesticks
            restartGame();
        });
        
        // Minecraft demo button
        document.querySelector('.minecraft-button').addEventListener('click', () => {
            window.location.href = 'https://threejs.org/examples/webgl_geometry_minecraft.html';
        });

        document.querySelector('.close-settings').addEventListener('click', () => {
            document.querySelector('.settings-panel').style.display = 'none';
        });
        */

        // Keyboard navigation - Commented out as settings-panel doesn't exist
        /*
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case 'Escape':
                    document.querySelector('.settings-panel').style.display = 'none';
                    break;
            }
        });
        */
        
        // Initialize wallet connection when page loads
        document.addEventListener('DOMContentLoaded', () => {
            console.log('🚀 DOMContentLoaded event fired');
            initWalletConnection();
            populateLeaderboard();
        });
    </script>
</body>
</html>
 